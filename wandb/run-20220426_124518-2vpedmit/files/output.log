
  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]/home/rishabh/practice_runs/cs4243-project/losses.py:28: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return F.kl_div(F.softmax(pred_sim_matrix / temperature).log(), F.softmax(target_matrix / temperature),






  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]






 84%|█████████▎ | 76/90 [00:15<00:01,  7.48it/s, acc 1=0.143349, acc 2=0.193128, l1m1=2.170205, l2m1=5.817799, l1m2=2.100800, l2m2=5.309913, train epoch=001]


  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]








 99%|██████████▉| 89/90 [00:16<00:00,  7.51it/s, acc 1=0.174091, acc 2=0.263014, l1m1=2.138366, l2m1=5.666147, l1m2=1.969315, l2m2=5.050781, train epoch=002]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







 97%|██████████▋| 87/90 [00:16<00:00,  7.60it/s, acc 1=0.195268, acc 2=0.330235, l1m1=2.103528, l2m1=5.522239, l1m2=1.783427, l2m2=4.724011, train epoch=003]

  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]









  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

 39%|████████████████████████████▊                                             | 7/18 [00:05<00:03,  3.37it/s, acc 1=0.256104, acc 2=0.386475, val epoch=004]








  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]






 90%|█████████▉ | 81/90 [00:14<00:01,  7.13it/s, acc 1=0.313850, acc 2=0.471812, l1m1=1.812040, l2m1=4.913848, l1m2=1.423792, l2m2=4.261603, train epoch=006]

  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]








  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]
train epoch 7, acc 1=0.376, acc 2=0.506, l1m1=1.660,l1m2=1.335, l2m1=4.748, l2m2=4.287, l3=4.993








  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

 44%|████████████████████████████████▉                                         | 8/18 [00:03<00:02,  4.45it/s, acc 1=0.470920, acc 2=0.473524, val epoch=008]








  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]

  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]







  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]






 96%|██████████▌| 86/90 [00:14<00:00,  7.56it/s, acc 1=0.696993, acc 2=0.659452, l1m1=0.831437, l2m1=4.706018, l1m2=0.943329, l2m2=4.212765, train epoch=015]


  6%|████                                                                      | 1/18 [00:03<00:55,  3.29s/it, acc 1=0.612630, acc 2=0.544922, val epoch=015]







100%|███████████| 90/90 [00:15<00:00,  7.53it/s, acc 1=0.723589, acc 2=0.670681, l1m1=0.762482, l2m1=4.695897, l1m2=0.919571, l2m2=4.207766, train epoch=016]



  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]








  0%|                                                                                                                                 | 0/18 [00:00<?, ?it/s]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]






 90%|█████████▉ | 81/90 [00:14<00:01,  7.37it/s, acc 1=0.747878, acc 2=0.676529, l1m1=0.694089, l2m1=4.692601, l1m2=0.896752, l2m2=4.200571, train epoch=018]


  0%|                                                                                                                                 | 0/90 [00:00<?, ?it/s]






 96%|██████████▌| 86/90 [00:14<00:00,  7.54it/s, acc 1=0.755246, acc 2=0.680164, l1m1=0.676098, l2m1=4.686263, l1m2=0.889091, l2m2=4.204941, train epoch=019]


 11%|████████▏                                                                 | 2/18 [00:03<00:22,  1.39s/it, acc 1=0.617188, acc 2=0.581380, val epoch=019]
validation epoch 19, acc 1 (doodle) = 0.612, acc 2 (real) = 0.573

training finished
torch.Size([100, 9])
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       1,792
│    └─Conv2d: 2-2                       36,928
│    └─Conv2d: 2-3                       73,856
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       221,376
│    └─Conv2d: 2-9                       331,968
│    └─BatchNorm2d: 2-10                 384
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
│    └─Conv2d: 2-13                      442,624
│    └─Conv2d: 2-14                      590,080
│    └─BatchNorm2d: 2-15                 512
│    └─Dropout: 2-16                     --
│    └─ReLU: 2-17                        --
│    └─Conv2d: 2-18                      1,180,160
│    └─Conv2d: 2-19                      2,359,808
│    └─BatchNorm2d: 2-20                 1,024
│    └─Dropout: 2-21                     --
│    └─ReLU: 2-22                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-23                      131,328
│    └─Linear: 2-24                      2,313
=================================================================
Total params: 5,521,993
Trainable params: 5,521,993
Non-trainable params: 0
=================================================================
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─Conv2d: 2-2                       9,248
│    └─Conv2d: 2-3                       36,992
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       590,336
│    └─Conv2d: 2-9                       2,359,808
│    └─BatchNorm2d: 2-10                 1,024
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-13                      131,328
│    └─Linear: 2-14                      2,313
=================================================================
Total params: 3,279,785
Trainable params: 3,279,785
Non-trainable params: 0
=================================================================
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─Conv2d: 2-2                       9,248
│    └─Conv2d: 2-3                       36,992
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       590,336
│    └─Conv2d: 2-9                       2,359,808
│    └─BatchNorm2d: 2-10                 1,024
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-13                      131,328
│    └─Linear: 2-14                      2,313
=================================================================
Total params: 3,279,785
Trainable params: 3,279,785
Non-trainable params: 0
=================================================================
torch.Size([100, 8192])
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─Conv2d: 2-2                       9,248
│    └─Conv2d: 2-3                       36,992
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       590,336
│    └─Conv2d: 2-9                       2,359,808
│    └─BatchNorm2d: 2-10                 1,024
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-13                      131,328
│    └─Linear: 2-14                      2,313
=================================================================
Total params: 3,279,785
Trainable params: 3,279,785
Non-trainable params: 0
=================================================================
torch.Size([100, 512, 4, 4])
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─Conv2d: 2-2                       9,248
│    └─Conv2d: 2-3                       36,992
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       590,336
│    └─Conv2d: 2-9                       2,359,808
│    └─BatchNorm2d: 2-10                 1,024
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-13                      131,328
│    └─Linear: 2-14                      2,313
=================================================================
Total params: 3,279,785
Trainable params: 3,279,785
Non-trainable params: 0
=================================================================
torch.Size([100, 8192])
torch.Size([100, 8192])
torch.Size([100, 512])
torch.Size([100, 9])
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
V2ConvNet                                --
├─Sequential: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─Conv2d: 2-2                       9,248
│    └─Conv2d: 2-3                       36,992
│    └─Conv2d: 2-4                       147,584
│    └─BatchNorm2d: 2-5                  256
│    └─Dropout: 2-6                      --
│    └─ReLU: 2-7                         --
│    └─Conv2d: 2-8                       590,336
│    └─Conv2d: 2-9                       2,359,808
│    └─BatchNorm2d: 2-10                 1,024
│    └─Dropout: 2-11                     --
│    └─ReLU: 2-12                        --
├─AdaptiveAvgPool2d: 1-2                 --
├─Sequential: 1-3                        --
│    └─Linear: 2-13                      131,328
│    └─Linear: 2-14                      2,313
=================================================================
Total params: 3,279,785
Trainable params: 3,279,785
Non-trainable params: 0
=================================================================
torch.Size([100, 512])
torch.Size([100, 3, 1, 1])
torch.Size([100, 9])
torch.Size([100, 9])
torch.Size([100, 4096])
torch.Size([100, 3, 1, 1])
torch.Size([100, 512])
torch.Size([100, 3, 1, 1])
torch.Size([100, 9])
